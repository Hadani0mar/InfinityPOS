@echo off
chcp 65001 >nul
title SmartInventory Pro Installer v1.0.0
echo.
echo ========================================
echo    SmartInventory Pro Installer v1.0.0
echo ========================================
echo.
echo Welcome to SmartInventory Pro
echo.
echo This installer will install SmartInventory Pro on your computer.
echo SmartInventory Pro is an advanced business management system.
echo.
set "APP_NAME=SmartInventory Pro"
set "APP_DIR=%PROGRAMFILES%\%APP_NAME%"
echo [INFO] Installing %APP_NAME%...
echo.
if not exist "%APP_DIR%" mkdir "%APP_DIR%"
REM Check if application is already installed
if exist "%APP_DIR%\SmartInventoryPro.exe" (
    echo [INFO] Found existing installation
    echo [INFO] Updating application...
    echo.
    REM Stop running application
    taskkill /f /im SmartInventoryPro.exe 2>nul
    timeout /t 2 /nobreak >nul
)
echo [INFO] Copying application files...
copy "SmartInventoryPro.exe" "%APP_DIR%\" >nul
copy "appsettings.json" "%APP_DIR%\" >nul
echo [SUCCESS] Application files copied
echo.
echo ========================================
if exist "%APP_DIR%\SmartInventoryPro.exe" (
    echo    Update completed successfully!
) else (
    echo    Installation completed successfully!
)
echo ========================================
echo.
echo %APP_NAME% installed/updated in: %APP_DIR%
echo.
echo Note: Your settings have been preserved
echo.
echo Press any key to exit...
pause >nul
